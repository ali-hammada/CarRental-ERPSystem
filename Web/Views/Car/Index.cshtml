@using ApplicationCore.Entities.Enums
@model IEnumerable<ApplicationCore.Entities.Car>

<div class="d-flex justify-content-between align-items-center mb-3">
  <h3>Cars</h3>
  <a asp-controller="Car" asp-action="Create" class="btn btn-success">
    <i class="bi bi-plus-circle"></i> Add New Car
  </a>
</div>

@if(!Model.Any())
{
  <div class="alert alert-info">
    No cars available yet. Click "Add New Car" to create one.
  </div>
}
else
{
  <div class="row">
    @foreach(var car in Model)
    {
      <div class="col-md-4 mb-3">
        <div class="card h-100 shadow-sm border-0">
          <!-- Car Image -->
          <div class="card-img-top" style="height: 200px; overflow: hidden; background-color: #f8f9fa;">
            @if(!string.IsNullOrEmpty(car.ImageUrl))
            {
              <img src="@car.ImageUrl"
                   alt="@car.Model"
                   class="w-100 h-100 object-fit-cover"
                   style="object-fit: cover;">
            }
            else
            {
              <div class="w-100 h-100 d-flex align-items-center justify-content-center">
                <i class="bi bi-car-front fs-1 text-secondary"></i>
              </div>
            }
          </div>

          <div class="card-body">
            <h5 class="card-title mb-2">
              <strong>@car.Model</strong>
              <span class="badge bg-info text-dark ms-2">@car.Year</span>
            </h5>

            <div class="mb-3">
              <p class="mb-1">
                <i class="bi bi-tag"></i> <strong>Plate:</strong> @car.PlateNumber
              </p>
              <p class="mb-1">
                <i class="bi bi-cash"></i> <strong>Price:</strong> @car.PricePerDay.ToString("C") / day
              </p>
              <p class="mb-0">
                <i class="bi bi-info-circle"></i> <strong>Status:</strong>
                <span class="badge bg-@(car.Status==CarStatus.Available ? "success" : "secondary")">
                  @car.Status
                </span>
              </p>
            </div>

            <hr>

            <div class="d-grid gap-2">
              <a asp-controller="Rentals"
                 asp-action="Open"
                 asp-route-carId="@car.Id"
                 class="btn btn-primary">
                <i class="bi bi-car-front"></i> Rent Now
              </a>

              <a asp-controller="Car"
                 asp-action="Edit"
                 asp-route-id="@car.Id"
                 class="btn btn-warning">
                <i class="bi bi-pencil-square"></i> Edit
              </a>

              <form asp-controller="Car"
                    asp-action="Delete"
                    asp-route-id="@car.Id"
                    method="post"
                    class="d-grid"
                    onsubmit="return confirm('Are you sure you want to delete this car?');">
                @Html.AntiForgeryToken()
                <button type="submit" class="btn btn-danger">
                  <i class="bi bi-trash"></i> Delete
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    }
  </div>
}
